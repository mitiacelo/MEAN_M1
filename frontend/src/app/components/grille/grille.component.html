<div class="grille-container">
  <h2>Quelle échelle préférez-vous pour modéliser votre centre commercial?</h2>
  
  <div class="selects-container">
    <div class="select-group">
      <label for="lignes">Nombre de lignes :</label>
      <select id="lignes" [(ngModel)]="lignes" name="lignes">
        <option *ngFor="let option of options" [value]="option">{{ option }}</option>
      </select>
    </div>
    <div class="select-group">
      <label for="colonnes">Nombre de colonnes :</label>
      <select id="colonnes" [(ngModel)]="colonnes" name="colonnes">
        <option *ngFor="let option of options" [value]="option">{{ option }}</option>
      </select>
    </div>
  </div>

  <div class="format-display">
    <h3>Format choisi : {{ format }}</h3>
  </div>

  <div class="grille-visuelle">
    <h3>Aperçu de la grille :</h3>
    
    <table class="grille-table" 
      [style.--colonnes]="colonnes" 
      [style.--lignes]="lignes">
      <thead>
        <tr>
          <th></th>
          <th *ngFor="let num of getNumeros()">{{ num }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let lettre of getLettres()">
          <td class="lettre-col">{{ lettre }}</td>
          <td 
            *ngFor="let num of getNumeros()" 
            class="block-cell"
            [class.selected]="isSelected(lettre, num)"
            [class.assigned]="isAssigned(lettre, num)"
            [style.background-color]="getBlockColor(lettre, num)"
            (click)="toggleCell(lettre, num)"
          >
            <!-- ✅ On cache le texte si le bloc est coloré -->
            <span *ngIf="!isAssigned(lettre, num)">
              {{ getBlockId(lettre, num) }}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <button (click)="sauvegarder()" class="save-btn">
    {{ grilleExiste ? 'Mettre à jour la grille' : 'Sauvegarder cette grille' }}
  </button>

  <button 
    class="save-btn"
    (click)="creerShopDepuisSelection()"
    [disabled]="selectedCells.size === 0">
    Créer un shop avec les blocs sélectionnés
  </button>

  <p *ngIf="grilleExiste" class="message-info">
    Grille actuelle : {{ grilleId }} ({{ lignes }}×{{ colonnes }})
  </p>
</div>